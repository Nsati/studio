{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Uttarakhand Getaways application.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Unique identifier for the user, matching Firebase Auth UID."
        },
        "displayName": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "mobile": {
          "type": "string",
          "description": "The user's 10-digit mobile number."
        },
        "role": {
          "type": "string",
          "description": "The user's role within the application (e.g., 'user', 'admin')."
        },
        "status": {
            "type": "string",
            "description": "The status of the user account.",
            "enum": ["pending", "active"]
        }
      },
      "required": [
        "uid",
        "displayName",
        "email",
        "mobile",
        "role",
        "status"
      ]
    },
    "City": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "City",
      "type": "object",
      "description": "Represents a city where hotels are located.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the city."
        },
        "name": {
          "type": "string",
          "description": "The name of the city."
        },
        "image": {
          "type": "string",
          "description": "An image ID from placeholder-images.json for the city."
        }
      },
      "required": [
        "id",
        "name",
        "image"
      ]
    },
    "Hotel": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Hotel",
      "type": "object",
      "description": "Represents a hotel in the Uttarakhand Getaways application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the hotel entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the hotel."
        },
        "city": {
          "type": "string",
          "description": "The city where the hotel is located."
        },
        "description": {
          "type": "string",
          "description": "A description of the hotel."
        },
        "images": {
          "type": "array",
          "description": "An array of image URLs for the hotel.",
          "items": {
            "type": "string"
          }
        },
        "amenities": {
          "type": "array",
          "description": "An array of amenities offered by the hotel.",
          "items": {
            "type": "string"
          }
        },
        "rating": {
          "type": "number",
          "description": "The hotel's rating."
        }
      },
      "required": [
        "id",
        "name",
        "city",
        "description",
        "images",
        "amenities",
        "rating"
      ]
    },
    "Room": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Room",
      "type": "object",
      "description": "Represents a room in a hotel.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the room entity."
        },
        "hotelId": {
          "type": "string",
          "description": "Reference to Hotel. (Relationship: Hotel 1:N Room)"
        },
        "type": {
          "type": "string",
          "description": "The type of room (e.g., 'Single', 'Double', 'Suite')."
        },
        "price": {
          "type": "number",
          "description": "The price per night for the room."
        },
        "capacity": {
          "type": "number",
          "description": "The maximum capacity of the room."
        },
        "totalRooms": {
          "type": "number",
          "description": "The total number of rooms of this type in the hotel."
        },
        "availableRooms": {
            "type": "number",
            "description": "The number of available rooms of this type."
        }
      },
      "required": [
        "id",
        "hotelId",
        "type",
        "price",
        "capacity",
        "totalRooms"
      ]
    },
    "Booking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Booking",
      "type": "object",
      "description": "Represents a booking made by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the booking entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Booking)"
        },
        "hotelId": {
            "type": "string",
            "description": "Reference to Hotel."
        },
        "roomId": {
          "type": "string",
          "description": "Reference to Room. (Relationship: Room 1:N Booking)"
        },
        "roomType": {
            "type": "string",
            "description": "The type of room booked (e.g., 'Standard', 'Deluxe')."
        },
        "checkIn": {
          "type": "string",
          "description": "The check-in date for the booking.",
          "format": "date-time"
        },
        "checkOut": {
          "type": "string",
          "description": "The check-out date for the booking.",
          "format": "date-time"
        },
        "guests": {
            "type": "number",
            "description": "Number of guests for the booking."
        },
        "totalPrice": {
            "type": "number",
            "description": "The total price paid for the booking."
        },
        "customerName": {
            "type": "string",
            "description": "Name of the customer who made the booking."
        },
        "customerEmail": {
            "type": "string",
            "description": "Email of the customer who made the booking.",
            "format": "email"
        },
        "status": {
          "type": "string",
          "description": "The status of the booking (e.g., 'CONFIRMED', 'CANCELLED')."
        },
        "createdAt": {
            "type": "string",
            "description": "The date the booking was created.",
            "format": "date-time"
        },
        "razorpayPaymentId": {
            "type": "string",
            "description": "The unique identifier for the payment from Razorpay."
        }
      },
      "required": [
        "id",
        "userId",
        "hotelId",
        "roomId",
        "roomType",
        "checkIn",
        "checkOut",
        "guests",
        "totalPrice",
        "customerName",
        "customerEmail",
        "status",
        "createdAt"
      ]
    },
    "TourPackage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tour Package",
      "type": "object",
      "description": "Represents a tour package offered by Uttarakhand Getaways.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tour package."
        },
        "title": {
          "type": "string",
          "description": "The title of the tour package."
        },
        "duration": {
          "type": "string",
          "description": "The duration of the tour (e.g., '6 Nights / 7 Days')."
        },
        "destinations": {
          "type": "array",
          "description": "An array of destination names covered in the tour.",
          "items": {
            "type": "string"
          }
        },
        "price": {
          "type": "number",
          "description": "The starting price of the package."
        },
        "image": {
          "type": "string",
          "description": "An image ID from placeholder-images.json for the package."
        },
        "description": {
          "type": "string",
          "description": "A short description of the tour package."
        }
      },
      "required": [
        "id",
        "title",
        "duration",
        "destinations",
        "price",
        "image",
        "description"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profiles. Uses path-based ownership for private user data. Each user has a single document in this collection.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/cities/{cityId}",
        "definition": {
          "entityName": "City",
          "schema": {
            "$ref": "#/backend/entities/City"
          },
          "description": "Stores city information. Publicly readable.",
          "params": [
            {
              "name": "cityId",
              "description": "The unique identifier of the city."
            }
          ]
        }
      },
      {
        "path": "/hotels/{hotelId}",
        "definition": {
          "entityName": "Hotel",
          "schema": {
            "$ref": "#/backend/entities/Hotel"
          },
          "description": "Stores hotel information. Publicly readable.",
          "params": [
            {
              "name": "hotelId",
              "description": "The unique identifier of the hotel."
            }
          ]
        }
      },
      {
        "path": "/hotels/{hotelId}/rooms/{roomId}",
        "definition": {
          "entityName": "Room",
          "schema": {
            "$ref": "#/backend/entities/Room"
          },
          "description": "Stores room information for each hotel. Used to show the available rooms of each hotel.",
          "params": [
            {
              "name": "hotelId",
              "description": "The unique identifier of the hotel."
            },
            {
              "name": "roomId",
              "description": "The unique identifier of the room."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/bookings/{bookingId}",
        "definition": {
          "entityName": "Booking",
          "schema": {
            "$ref": "#/backend/entities/Booking"
          },
          "description": "Stores booking information for each user.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "bookingId",
              "description": "The unique identifier of the booking."
            }
          ]
        }
      },
      {
        "path": "/tourPackages/{packageId}",
        "definition": {
          "entityName": "TourPackage",
          "schema": {
            "$ref": "#/backend/entities/TourPackage"
          },
          "description": "Stores tour package information. Publicly readable.",
          "params": [
            {
              "name": "packageId",
              "description": "The unique identifier of the tour package."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support a hotel booking application with user authentication, hotel browsing, booking management, and admin features, while prioritizing security and scalability. It adheres to the principles of Authorization Independence, Structural Segregation, Access Modeling, and Data Clarity.\n\n**Authorization Independence:**\n\n*   **Users:** User roles are stored directly in the `/users/{userId}` document. This avoids relying on custom claims, simplifying authentication logic.\n*   **Hotels:** Hotel data is stored in a top-level `/hotels` collection. There is no need for authorization checks based on parent documents.\n*   **Rooms:** Room data is stored in a subcollection `/hotels/{hotelId}/rooms/{roomId}`. This allows querying rooms by hotel and managing inventory per room type.\n*   **Bookings:** Bookings are stored in the `/users/{userId}/bookings/{bookingId}` subcollection to make them independently accessible based on the user.\n\n**Structural Segregation:**\n\n*   User data (`/users/{userId}`) is segregated from hotel and booking data, ensuring different security requirements are isolated.\n*   Hotel data (`/hotels`) is separate from user-specific data.\n*   Bookings (`/users/{userId}/bookings/{bookingId}`) are segregated to allow user-specific access control.\n\n**Access Modeling:**\n\n*   **Private Data:** User profiles are stored under `/users/{userId}`, implementing Path-Based ownership.\n*   **Collaborative Data:** Admin access for hotel management is implemented by checking the `role` field within the user's profile document (`/users/{userId}`).\n\n**QAPs (Rules are not Filters):**\n\n*   The structure allows secure `list` operations. For example:\n    *   Listing hotels: A rule can allow public read access to the `/hotels` collection.\n    *   Listing bookings: A rule can allow a user to only list bookings under their own `/users/{userId}/bookings` path.\n    *   Listing rooms: A rule can allow public read access to the `/hotels/{hotelId}/rooms` collection to list available rooms for hotel.\n\n**Invariants:**\n\n*   Ownership: Bookings are owned by the user via the `/users/{userId}/bookings` path.\n*   Inventory: Room availability is managed in the `/hotels/{hotelId}/rooms/{roomId}` documents.\n\nThe database is structured to facilitate a secure, scalable, and debuggable system, aligning with the defined design principles and strategy mandates."
  }
}
